from spire.xls import Workbook

# Load the Excel file
wb = Workbook()
wb.LoadFromFile("C:\\Users\\codhiambo\\Desktop\\data_house\\sample_source.xlsx")

# Get the first worksheet
data_sheet = wb.Worksheets.get_Item("Sheet1")

# Create a dictionary to store the counts of unique values
value_counts = {}

# Define the column (e.g., "ACCT1" is in column A, i.e., 1st column, so we use column index 1)
# Assuming data starts from the 2nd row, skipping headers
for row in range(2, data_sheet.LastRow + 1):
    cell_value = data_sheet.Range[f"E{row}"].Value  # Replace "A" with your actual column

    if cell_value in value_counts:
        value_counts[cell_value] += 1
    else:
        value_counts[cell_value] = 1

# Print the result (each value and its count)
for value, count in value_counts.items():
    print(f"Value: {value}, Count: {count}")

# Optionally, write the results to a new worksheet or Excel file
result_sheet = wb.Worksheets.Add("Counts")

# Write header for results
result_sheet.Range["A1"].Value = "Value"
result_sheet.Range["B1"].Value = "Count"

# Write the value counts to the result sheet
row = 2
for value, count in value_counts.items():
    result_sheet.Range[f"A{row}"].Value = str(value)  # Convert value to string
    result_sheet.Range[f"B{row}"].Value = str(count)  # Convert count to string
    row += 1

# Save the result to a new Excel file
wb.SaveToFile("C:\\Users\\codhiambo\\Desktop\\data_house\\value_counts.xlsx")
